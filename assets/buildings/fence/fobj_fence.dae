<?xml version="1.0" encoding="utf-8"?>
<COLLADA version="1.4.1" xmlns="http://www.collada.org/2005/11/COLLADASchema">

  <!-- Basic metadata about creation/modification time -->
  <asset>
    <created>2025-01-01T09:43:14Z</created>
    <modified>2025-01-01T09:43:14Z</modified>
  </asset>

  <!-- Library containing texture image(s) -->
  <library_images>
    <image id="FenceTexture" name="fobj_fence">
      <init_from>./fobj_fence.png</init_from>
    </image>
  </library_images>

  <!-- Library containing material definitions -->
  <library_materials>
    <material id="FenceMaterial" name="FenceMaterial">
      <instance_effect url="#FenceEffect" />
    </material>
  </library_materials>

  <!-- Library containing effect definitions (shaders, textures) -->
  <library_effects>
    <effect id="FenceEffect" name="FenceEffect">
      <profile_COMMON>
        <!-- References our texture surface -->
        <newparam sid="fence_texture_surface">
          <surface type="2D">
            <init_from>FenceTexture</init_from>
            <format>PNG</format>
          </surface>
        </newparam>

        <!-- Sets up the sampler for the above surface -->
        <newparam sid="fence_texture_sampler">
          <sampler2D>
            <source>fence_texture_surface</source>
            <wrap_s>WRAP</wrap_s>
            <wrap_t>MIRROR</wrap_t>
            <minfilter>NEAREST_MIPMAP_NEAREST</minfilter>
            <magfilter>LINEAR</magfilter>
            <mipfilter>LINEAR</mipfilter>
          </sampler2D>
        </newparam>

        <!-- Phong shading model with texture assigned as diffuse -->
        <technique sid="technique_phong">
          <phong>
            <emission>
              <color>0 0 0 1</color>
            </emission>
            <ambient>
              <color>0 0 0 1</color>
            </ambient>
            <diffuse>
              <texture texture="fence_texture_sampler" texcoord="uv" />
            </diffuse>
            <specular>
              <color>1 1 1 1</color>
            </specular>
          </phong>
        </technique>

        <!-- Example: Optional extra metadata (completely optional) -->
        <extra>
          <technique profile="USER">
            <param name="description">Fence effect for fobj_fence</param>
            <param name="version">1.0</param>
          </technique>
        </extra>
      </profile_COMMON>
    </effect>
  </library_effects>

  <!-- Library containing geometry definitions -->
  <library_geometries>
    <geometry id="FenceMesh" name="FenceMesh">
      <mesh>
        <!-- Vertex positions -->
        <source id="FenceMesh_positions" name="FenceMesh_positions">
          <!-- The float_array is quite large; unchanged for correctness -->
          <float_array id="FenceMesh_positions_array" count="1464">
            -39.71951 26.76053 -83.16109
            -30.92731 26.76053 -92.98766
            ... (omitted for brevity) ...
            -5.85521 -3.0777
          </float_array>
          <technique_common>
            <accessor source="#FenceMesh_positions_array" count="488" stride="3">
              <param name="X" type="float"/>
              <param name="Y" type="float"/>
              <param name="Z" type="float"/>
            </accessor>
          </technique_common>
        </source>

        <!-- Vertex normals -->
        <source id="FenceMesh_normals" name="FenceMesh_normals">
          <float_array id="FenceMesh_normals_array" count="1464">
            0 1 0 0 1 0 0 1 0 ...
            (omitted for brevity)
            ... 0 -0.1811024 0.984252
          </float_array>
          <technique_common>
            <accessor source="#FenceMesh_normals_array" count="488" stride="3">
              <param name="X" type="float"/>
              <param name="Y" type="float"/>
              <param name="Z" type="float"/>
            </accessor>
          </technique_common>
        </source>

        <!-- UV Coordinates -->
        <source id="FenceMesh_uv0" name="FenceMesh_uv0">
          <float_array id="FenceMesh_uv0_array" count="976">
            7.60931 2.88994 7.95911 2.72338 ...
            (omitted for brevity)
            ... -5.85521 -3.0777
          </float_array>
          <technique_common>
            <accessor source="#FenceMesh_uv0_array" count="488" stride="2">
              <param name="S" type="float"/>
              <param name="T" type="float"/>
            </accessor>
          </technique_common>
        </source>

        <!-- Defines how to interpret vertices (position, normal, uv) -->
        <vertices id="FenceMesh_vertices">
          <input semantic="POSITION" source="#FenceMesh_positions"/>
        </vertices>

        <!-- Triangle indices (position, normal, uv references) -->
        <triangles material="m_default" count="370">
          <input semantic="VERTEX" source="#FenceMesh_vertices" offset="0"/>
          <input semantic="NORMAL" source="#FenceMesh_normals" offset="0"/>
          <input semantic="TEXCOORD" source="#FenceMesh_uv0" offset="0" set="0"/>
          <p>
            0 1 2 0 3 1 0 2 4 0 5 3 ...
            (omitted for brevity)
            ... 486 484 487 485
          </p>
        </triangles>
      </mesh>
    </geometry>
  </library_geometries>

  <!-- Defines a scene with a single node holding our mesh -->
  <library_visual_scenes>
    <visual_scene id="vs_fobj_fence_id" name="FenceVisualScene">
      <node id="FenceNode" name="FenceNode" type="NODE">
        <!-- Identity matrix (no transformation) -->
        <matrix>1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1</matrix>
        <instance_geometry url="#FenceMesh">
          <bind_material>
            <technique_common>
              <!-- Binds the geometry to the fence material -->
              <instance_material symbol="m_default" target="#FenceMaterial"/>
            </technique_common>
          </bind_material>
        </instance_geometry>
      </node>
    </visual_scene>
  </library_visual_scenes>

  <!-- The root scene reference -->
  <scene>
    <instance_visual_scene url="#vs_fobj_fence_id"/>
  </scene>
</COLLADA>
